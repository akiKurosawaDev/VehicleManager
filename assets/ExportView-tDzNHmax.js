import{_ as m,r as w,w as g,c as b,o as x,a as n,b as l,d as o,u as d,e as y,f as k,g as E,h as z,i as r}from"./index-qWphhHfR.js";const C={class:"mt-3"},F={__name:"ExportView",setup(P){const{isAuthenticated:c,isLoading:u,getAccessTokenSilently:p}=k();E();const i=w(!1),f=async()=>await p({authorizationParams:{audience:"https://pbshzgfwctlreejwziws.supabase.co/functions/v1/vehicle-daily-report-server"}}),v=async()=>{i.value=!0;try{if(!c.value)throw new Error("session logouted.");const s=await f(),{data:e,status:a}=await z.post("https://pbshzgfwctlreejwziws.supabase.co/functions/v1/vehicle-daily-report-server",JSON.stringify({request:"exportPDF"}),{headers:{Authorization:"Bearer "+s}});if(a!==200)throw new Error(`Supabase Edge Function Response Status Code ${a}`);console.log(e);const t=document.createElement("a");t.href=e.response,t.setAttribute("download","exportPDF.pdf"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(s){console.log(s)}finally{i.value=!1}};return g(()=>{}),(s,e)=>{const a=r("v-btn"),t=r("v-sheet"),_=r("v-container"),h=r("v-main");return x(),b(h,{class:"main-area"},{default:n(()=>[l(_,{fluid:"",minWidth:"320px",maxWidth:"1280px",class:"fill-height"},{default:n(()=>[l(t,{class:"mx-auto pa-5",width:"300",elevation:"12",rounded:""},{default:n(()=>[e[1]||(e[1]=o("div",null,[o("h2",{class:"mb-3",style:{"text-align":"center"}},"車輛日報出力")],-1)),e[2]||(e[2]=o("div",null,[o("p",null,"「PDFファイル」ボタンを押すと車輛日報をダウンロードがはじまります。"),o("p",null,"（Google Spreadsheet 使用）")],-1)),o("div",C,[l(a,{block:"",color:"primary",loading:i.value,disabled:!d(c)&&d(u),onClick:v},{default:n(()=>e[0]||(e[0]=[y("PDFファイル")])),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1})}}},D=m(F,[["__scopeId","data-v-85fa67eb"]]);export{D as default};
